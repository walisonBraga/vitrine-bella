<app-navbar-home></app-navbar-home>

<section class="hero-x mb-5" [@carouselAnimation]="currentSlideIndex">
  <div class="carousel slide" id="heroCarousel" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div
        *ngFor="let slide of slides; let i = index; trackBy: trackBySlide"
        class="carousel-item"
        [class.active]="i === currentSlideIndex"
      >
        <div
          class="hero-slide d-flex align-items-center text-center text-white"
          [style.background]="'url(' + slide.img + ') center/cover no-repeat'"
        >
          <div class="container py-5 py-md-6">
            <h1
              class="display-4 fw-bold mb-3 animate__animated animate__fadeInDown"
            >
              {{ slide.titulo }}
            </h1>
            <p class="lead mb-4 animate__animated animate__fadeInUp">
              {{ slide.subtitulo }}
            </p>
            <a
              [routerLink]="slide.link"
              class="btn btn-lg btn-primary px-4 shadow animate__animated animate__zoomIn"
              [attr.aria-label]="'Ver ' + slide.titulo"
            >
              Ver Catálogo
            </a>
          </div>
        </div>
      </div>
    </div>
    <button
      class="carousel-control-prev"
      type="button"
      data-bs-target="#heroCarousel"
      data-bs-slide="prev"
      aria-label="Slide anterior"
    >
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button
      class="carousel-control-next"
      type="button"
      data-bs-target="#heroCarousel"
      data-bs-slide="next"
      aria-label="Próximo slide"
    >
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</section>

<!-- CATEGORIAS EM DESTAQUE -->
<nav class="categorias-x container mb-5" [@stagger]="categoriesState">
  <ul class="row gx-2 gy-2 justify-content-center">
    <li
      *ngFor="let cat of categorias; trackBy: trackByCategory"
      class="col-6 col-md-auto"
    >
      <button
        class="btn btn-outline-secondary rounded-pill px-4 py-2 animate__animated animate__fadeIn"
        [class.active]="cat.id === categoriaSelecionada"
        (click)="filtrar(cat.id)"
        [attr.aria-pressed]="cat.id === categoriaSelecionada"
        [attr.aria-label]="'Filtrar por ' + cat.nome"
      >
        <i [class]="cat.icon" class="me-2"></i>{{ cat.nome }}
      </button>
    </li>
  </ul>
</nav>

<!-- LISTAGEM DE PRODUTOS -->
<section class="produtos-x container mb-5" [@stagger]="productsState">
  <div class="row g-4">
    <ng-container *ngFor="let p of produtosFiltrados; trackBy: trackByProduct">
      <div class="col-6 col-md-4 col-lg-3">
        <mat-card
          class="card-x h-100 shadow-sm border-0 animate__animated animate__fadeInUp"
        >
          <img
            mat-card-image
            [src]="p.img"
            [alt]="'Imagem do produto ' + p.nome"
            class="rounded-top"
            loading="lazy"
            (error)="handleImageError($event)"
          />
          <mat-card-content class="d-flex flex-column">
            <mat-card-title class="fw-semibold">{{ p.nome }}</mat-card-title>
            <p class="text-muted mb-3">{{ p.descricao }}</p>
            <p class="fw-bold mb-3">R$ {{ p.preco | number : "1.2-2" }}</p>
            <button
              mat-raised-button
              color="primary"
              class="mt-auto w-100"
              (click)="adicionarCarrinho(p)"
              [attr.aria-label]="'Adicionar ' + p.nome + ' ao carrinho'"
            >
              Comprar
            </button>
          </mat-card-content>
        </mat-card>
      </div>
    </ng-container>
  </div>
</section>

<!-- CARROSSEL DE DESTAQUE -->
<section
  class="destaques-x container mb-5"
  *ngIf="produtosChunked.length"
  [@stagger]="productsState"
>
  <div class="carousel slide" id="destaquesCarousel" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div
        *ngFor="let chunk of produtosChunked; let i = index"
        class="carousel-item"
        [class.active]="i === 0"
      >
        <div class="row g-4">
          <div
            *ngFor="let p of chunk; trackBy: trackByProduct"
            class="col-6 col-md-4 col-lg-3"
          >
            <mat-card
              class="card-x h-100 shadow-sm border-0 animate__animated animate__fadeInUp"
            >
              <img
                mat-card-image
                [src]="p.img"
                [alt]="'Imagem do produto ' + p.nome"
                class="rounded-top"
                loading="lazy"
                (error)="handleImageError($event)"
              />
              <mat-card-content class="d-flex flex-column">
                <mat-card-title class="fw-semibold">{{
                  p.nome
                }}</mat-card-title>
                <p class="text-muted mb-3">{{ p.descricao }}</p>
                <p class="fw-bold mb-3">R$ {{ p.preco | number : "1.2-2" }}</p>
                <button
                  mat-raised-button
                  color="primary"
                  class="mt-auto w-100"
                  (click)="adicionarCarrinho(p)"
                  [attr.aria-label]="'Adicionar ' + p.nome + ' ao carrinho'"
                >
                  Comprar
                </button>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    </div>
    <button
      class="carousel-control-prev"
      type="button"
      data-bs-target="#destaquesCarousel"
      data-bs-slide="prev"
      aria-label="Slide anterior"
    >
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button
      class="carousel-control-next"
      type="button"
      data-bs-target="#destaquesCarousel"
      data-bs-slide="next"
      aria-label="Próximo slide"
    >
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</section>
